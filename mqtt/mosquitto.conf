# Mosquitto MQTT Broker Configuration
# Configuration for telemetry, real-time messaging and IoT support

listener 1883
protocol mqtt

# WebSocket listener for browser-based clients
listener 9001
protocol websockets

# Persistence
persistence true
persistence_location /mqtt/data/

# Logging
log_dest stdout
log_dest file /mqtt/logs/mosquitto.log
log_timestamp true
log_type all

# Security
allow_anonymous false
password_file /mqtt/acl/passwords.txt
acl_file /mqtt/acl/acl.acl

# Performance
max_connections -1
max_queued_messages 1000
message_size_limit 0

# Client settings
persistent_client_expiration 7d
client_id_prefix ""
allow_zero_length_clientid false

# Performance tuning
autosave_interval 1800
autosave_on_changes false
upgrade_outgoing_qos false

# Connection limits
max_inflight_messages 20

# Bridges (for federation with external brokers, if needed)
# bridge_protocol_version mqttv311
# connection external_broker
# address external.broker.com:1883
# remote_clientid mosquitto_bridge
# remote_username bridge_user
# remote_password bridge_pass
# topic # both 0

# SSL/TLS (configure if using certificate-based authentication)
# cafile /mqtt/certs/ca.crt
# certfile /mqtt/certs/server.crt
# keyfile /mqtt/certs/server.key
